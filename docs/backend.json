{
  "entities": {
    "UserEmail": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserEmail",
      "type": "object",
      "description": "Stores user email addresses and their subscription status.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user email entry."
        },
        "email": {
          "type": "string",
          "description": "The user's email address.",
          "format": "email"
        },
        "subscribed": {
          "type": "boolean",
          "description": "Indicates whether the user is subscribed to the newsletter (true) or not (false). Defaults to false."
        }
      },
      "required": [
        "id",
        "email",
        "subscribed"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/emails/{emailId}",
        "definition": {
          "entityName": "UserEmail",
          "schema": {
            "$ref": "#/backend/entities/UserEmail"
          },
          "description": "Stores user email addresses and their subscription status.  The 'subscribed' field defaults to false.",
          "params": [
            {
              "name": "emailId",
              "description": "Unique identifier for the email document. This is automatically generated by Firestore."
            }
          ]
        }
      }
    ],
    "reasoning": "The data structure prioritizes user email storage and subscription status. The key design choice is using the `/emails` collection to store email subscriptions with a boolean value. This approach provides a flexible, and easily queryable solution. The structure ensures each document contains only the user's email and subscription status simplifying data retrieval and management.\n\nThis approach also supports Authorization Independence.  Rules can validate the submitted email format. \n\nThe structure also supports the required QAPs by enabling secure `list` operations on the `/emails` collection because the security requirements are homogeneous."
  }
}